<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Machine - Song Creation Guide</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/tonal@5.0.0/browser/tonal.min.js"></script>
    <script src="https://omnibrain.github.io/svguitar/js/svguitar.umd.js"></script>
</head>
<body>
    <main class="app-container">
        <header class="app-header">
            <h1>Music Machine</h1>
            <p>Your guided journey from mood to complete song</p>
        </header>

        <div class="progress-bar">
            <div class="progress-step active" data-step="1">Mood</div>
            <div class="progress-step" data-step="2">Key & Tempo</div>
            <div class="progress-step" data-step="3">Chords</div>
            <div class="progress-step" data-step="4">Drums</div>
            <div class="progress-step" data-step="5">Bass</div>
            <div class="progress-step" data-step="6">Melody</div>
            <div class="progress-step" data-step="7">Structure</div>
            <div class="progress-step" data-step="8">Arrangement</div>
            <div class="progress-step" data-step="9">Lyrics</div>
            <div class="progress-step" data-step="10">Export</div>
        </div>

        <section id="step-mood" class="step-section active">
            <h2>Step 1: Choose Your Mood & Genre</h2>
            <p>Start your musical journey by selecting the mood and genre that inspire you.</p>
            
            <div class="selection-group">
                <h3>Mood</h3>
                <div id="mood-options" class="option-grid"></div>
            </div>

            <div class="selection-group">
                <h3>Genre</h3>
                <div id="genre-options" class="option-grid"></div>
            </div>

            <button id="mood-next" class="next-button" disabled>Next: Key & Tempo</button>
        </section>

        <section id="step-key-tempo" class="step-section">
            <h2>Step 2: Key & Tempo</h2>
            <p>Based on your mood and genre, here are suggested musical foundations.</p>
            
            <div class="selection-group">
                <h3>Musical Key</h3>
                <div id="key-options" class="option-grid"></div>
            </div>

            <div class="selection-group">
                <h3>Scale</h3>
                <div id="scale-options" class="option-grid"></div>
                <button id="scale-theory-btn" class="theory-toggle" onclick="showKeyScaleTheory()" style="display: none;">
                    ðŸŽ“ Learn Scale Theory
                </button>
            </div>

            <div class="selection-group">
                <h3>Tempo (BPM)</h3>
                <div id="tempo-options" class="option-grid"></div>
            </div>

            <div class="navigation">
                <button id="key-tempo-back" class="back-button">Back</button>
                <button id="key-tempo-next" class="next-button" disabled>Next: Chord Progression</button>
            </div>
        </section>

        <section id="step-chords" class="step-section">
            <h2>Step 3: Chord Progression</h2>
            <p>Choose a chord progression that fits your genre and key.</p>
            
            <div id="chord-progressions" class="chord-grid"></div>
            <div id="chord-display" class="chord-display"></div>

            <div class="navigation">
                <button id="chords-back" class="back-button">Back</button>
                <button id="chords-next" class="next-button" disabled>Next: Drum Pattern</button>
            </div>
        </section>

        <section id="step-drums" class="step-section">
            <h2>Step 4: Drum Pattern</h2>
            <p>Select a rhythmic foundation for your song.</p>
            
            <div id="drum-patterns" class="drum-grid"></div>
            <div id="drum-display" class="drum-display"></div>

            <div class="navigation">
                <button id="drums-back" class="back-button">Back</button>
                <button id="drums-next" class="next-button" disabled>Next: Bass Line</button>
            </div>
        </section>

        <section id="step-bass" class="step-section">
            <h2>Step 5: Bass Line</h2>
            <p>Create a bass line that follows your chord progression.</p>
            
            <div id="bass-options" class="bass-grid"></div>
            <div id="bass-display" class="bass-display"></div>

            <div class="navigation">
                <button id="bass-back" class="back-button">Back</button>
                <button id="bass-next" class="next-button" disabled>Next: Melody Ideas</button>
            </div>
        </section>

        <section id="step-melody" class="step-section">
            <h2>Step 6: Melody Ideas</h2>
            <p>Explore melodic patterns that work with your chord progression.</p>
            
            <div id="melody-suggestions" class="melody-grid"></div>
            <div id="melody-display" class="melody-display"></div>

            <div class="navigation">
                <button id="melody-back" class="back-button">Back</button>
                <button id="melody-next" class="next-button" disabled>Next: Song Structure</button>
            </div>
        </section>

        <section id="step-structure" class="step-section">
            <h2>Step 7: Song Structure</h2>
            <p>Build your complete song structure by assigning sections.</p>
            
            <div id="structure-builder" class="structure-builder">
                <div class="structure-templates"></div>
                <div class="structure-editor"></div>
            </div>

            <div class="navigation">
                <button id="structure-back" class="back-button">Back</button>
                <button id="structure-next" class="next-button" disabled>Next: Arrangement</button>
            </div>
        </section>

        <section id="step-arrangement" class="step-section">
            <h2>Step 8: Arrangement & Layering</h2>
            <p>Add dynamics and instrumentation to different sections.</p>
            
            <div id="arrangement-tips" class="arrangement-panel"></div>

            <div class="navigation">
                <button id="arrangement-back" class="back-button">Back</button>
                <button id="arrangement-next" class="next-button" disabled>Next: Lyrics</button>
            </div>
        </section>

        <section id="step-lyrics" class="step-section">
            <h2>Step 9: Lyric Helper</h2>
            <p>Write your lyrics with thematic suggestions based on your mood.</p>
            
            <div class="lyrics-container">
                <div class="lyrics-tools">
                    <h3>Thematic Words</h3>
                    <div id="thematic-words" class="word-suggestions"></div>
                    <button id="generate-words" class="generate-button">Generate More Words</button>
                </div>
                <div class="lyrics-editor">
                    <h3>Your Lyrics</h3>
                    <textarea id="lyrics-text" placeholder="Write your lyrics here..."></textarea>
                </div>
            </div>

            <div class="navigation">
                <button id="lyrics-back" class="back-button">Back</button>
                <button id="lyrics-next" class="next-button">Next: Export & Summary</button>
            </div>
        </section>

        <section id="step-export" class="step-section">
            <h2>Step 10: Export & Summary</h2>
            <p>Your complete song plan is ready! Review and export your creation.</p>
            
            <div id="song-summary" class="song-summary"></div>
            
            <div class="export-options">
                <button id="export-text" class="export-button">Export as Text</button>
                <button id="export-json" class="export-button">Export as JSON</button>
                <button id="export-midi" class="export-button">Export MIDI Files</button>
                <button id="export-ableton" class="export-button">Download Ableton Template</button>
                <button id="start-over" class="start-over-button">Start New Song</button>
            </div>
            
            <div id="midi-export-options" class="midi-export-panel" style="display: none;">
                <h3>MIDI Export Options</h3>
                <div class="track-options">
                    <label><input type="checkbox" id="export-chords" checked> Chord Progression</label>
                    <label><input type="checkbox" id="export-bass" checked> Bass Line</label>
                    <label><input type="checkbox" id="export-melody" checked> Melody</label>
                    <label><input type="checkbox" id="export-drums" checked> Drum Pattern</label>
                    <label><input type="checkbox" id="export-harmony" checked> Harmony Parts</label>
                    <label><input type="checkbox" id="export-pads" checked> Background Pads</label>
                </div>
                <div class="arrangement-options">
                    <h4>Arrangement Settings</h4>
                    <label>Song Length: <select id="song-length">
                        <option value="short">Short (2-3 minutes)</option>
                        <option value="medium" selected>Medium (3-4 minutes)</option>
                        <option value="long">Long (4-5 minutes)</option>
                    </select></label>
                    <label>Variations: <select id="midi-variations">
                        <option value="1">Single version</option>
                        <option value="2" selected>2 variations per track</option>
                        <option value="3">3 variations per track</option>
                    </select></label>
                </div>
                <button id="generate-midi" class="export-button">Generate MIDI Files</button>
            </div>

            <div class="navigation">
                <button id="export-back" class="back-button">Back</button>
            </div>
        </section>
    </main>

    <script type="module" src="js/midi-generator.js"></script>
    <script type="module" src="js/chord-diagrams.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>