<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studio - Music Machine</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/studio.css">
</head>
<body>
    <header class="app-header">
        <h1>Music Machine - Studio</h1>
        <nav class="main-nav">
            <a href="index.html" class="nav-link">üè† Home</a>
            <a href="chords.html" class="nav-link">üé∏ Chords</a>
            <a href="scales.html" class="nav-link">üéµ Scales</a>
            <a href="circle-of-fifths.html" class="nav-link">‚≠ï Circle of Fifths</a>
            <a href="strumming.html" class="nav-link">üéº Strumming</a>
            <a href="studio.html" class="nav-link active">üéπ Studio</a>
        </nav>
    </header>

    <!-- Studio Workspace -->
    <div class="studio-container">

        <!-- Transport Bar -->
        <div class="transport-bar">
            <div class="transport-controls">
                <button id="play-btn" class="transport-btn" title="Play">‚ñ∂</button>
                <button id="stop-btn" class="transport-btn" title="Stop">‚¨õ</button>
                <button id="record-btn" class="transport-btn" title="Record">‚è∫</button>
            </div>

            <div class="transport-info">
                <div class="tempo-control">
                    <label>BPM:</label>
                    <input type="number" id="tempo-input" value="120" min="40" max="240" step="1">
                    <button id="tap-tempo" class="transport-btn-small">Tap</button>
                </div>
                <div class="key-display">
                    <label>Key:</label>
                    <span id="current-key-display">C Major</span>
                </div>
            </div>

            <div class="transport-actions">
                <button id="clear-btn" class="transport-btn-small" title="Clear All">üóëÔ∏è Clear</button>
                <button id="export-midi-btn" class="transport-btn-small" title="Export MIDI">üíæ MIDI</button>
                <button id="save-project-btn" class="transport-btn-small" title="Save Project">üíæ Save</button>
            </div>
        </div>

        <!-- Main Workspace Grid -->
        <div class="studio-workspace">

            <!-- Left Sidebar: Controls & Palette -->
            <div class="sidebar sidebar-left">
                <!-- Key & Scale Selector -->
                <div class="panel">
                    <h3 class="panel-title">Key & Scale</h3>
                    <div class="key-selector">
                        <label>Root Note:</label>
                        <select id="key-root-select" class="studio-select">
                            <option value="C">C</option>
                            <option value="C#">C# / Db</option>
                            <option value="D">D</option>
                            <option value="D#">D# / Eb</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                            <option value="F#">F# / Gb</option>
                            <option value="G">G</option>
                            <option value="G#">G# / Ab</option>
                            <option value="A">A</option>
                            <option value="A#">A# / Bb</option>
                            <option value="B">B</option>
                        </select>

                        <label>Scale Type:</label>
                        <select id="scale-type-select" class="studio-select">
                            <option value="major">Major</option>
                            <option value="minor">Natural Minor</option>
                            <option value="harmonic minor">Harmonic Minor</option>
                            <option value="melodic minor">Melodic Minor</option>
                            <option value="dorian">Dorian</option>
                            <option value="phrygian">Phrygian</option>
                            <option value="lydian">Lydian</option>
                            <option value="mixolydian">Mixolydian</option>
                            <option value="locrian">Locrian</option>
                            <option value="major pentatonic">Major Pentatonic</option>
                            <option value="minor pentatonic">Minor Pentatonic</option>
                            <option value="blues">Blues</option>
                        </select>
                    </div>
                </div>

                <!-- Chord Palette -->
                <div class="panel">
                    <h3 class="panel-title">Chord Palette</h3>
                    <p class="panel-hint">Drag chords to the timeline</p>
                    <div id="chord-palette" class="chord-palette"></div>
                </div>

                <!-- Quick Actions -->
                <div class="panel">
                    <h3 class="panel-title">Quick Actions</h3>
                    <button id="generate-progression-btn" class="action-btn">üé≤ Generate Progression</button>
                    <button id="suggest-melody-btn" class="action-btn">üéµ Suggest Melody</button>
                    <button id="add-variation-btn" class="action-btn">‚ú® Add Variation</button>
                </div>
            </div>

            <!-- Center: Timeline & Editors -->
            <div class="workspace-center">

                <!-- Chord Progression Timeline -->
                <div class="editor-panel">
                    <div class="editor-header">
                        <h3>Chord Progression</h3>
                        <div class="editor-controls">
                            <button id="loop-btn" class="editor-btn" title="Loop">üîÅ</button>
                            <span class="editor-info">Measures: <span id="measure-count">4</span></span>
                        </div>
                    </div>
                    <div class="timeline-container">
                        <div id="chord-timeline" class="chord-timeline"></div>
                    </div>
                </div>

                <!-- Melody Editor -->
                <div class="editor-panel">
                    <div class="editor-header">
                        <h3>Melody Editor</h3>
                        <div class="editor-controls">
                            <button id="melody-clear-btn" class="editor-btn" title="Clear Melody">üóëÔ∏è</button>
                            <button id="melody-quantize-btn" class="editor-btn" title="Quantize">‚ö°</button>
                            <label class="editor-label">
                                Note Length:
                                <select id="note-length-select" class="editor-select">
                                    <option value="0.25">1/16</option>
                                    <option value="0.5" selected>1/8</option>
                                    <option value="1">1/4</option>
                                    <option value="2">1/2</option>
                                    <option value="4">Whole</option>
                                </select>
                            </label>
                        </div>
                    </div>
                    <div class="piano-roll-container">
                        <div id="piano-roll" class="piano-roll"></div>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar: Suggestions & Info -->
            <div class="sidebar sidebar-right">

                <!-- Smart Suggestions -->
                <div class="panel">
                    <h3 class="panel-title">Smart Suggestions</h3>
                    <div id="smart-suggestions" class="suggestions-list">
                        <p class="panel-hint">Add chords to see suggestions...</p>
                    </div>
                </div>

                <!-- Theory Info -->
                <div class="panel">
                    <h3 class="panel-title">Theory Info</h3>
                    <div id="theory-info" class="theory-info">
                        <div class="info-item">
                            <label>Current Key:</label>
                            <span id="info-key">C Major</span>
                        </div>
                        <div class="info-item">
                            <label>Scale Notes:</label>
                            <span id="info-scale-notes">C D E F G A B</span>
                        </div>
                        <div class="info-item">
                            <label>Chords in Key:</label>
                            <div id="info-key-chords" class="key-chords-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Progression Analysis -->
                <div class="panel">
                    <h3 class="panel-title">Progression Analysis</h3>
                    <div id="progression-analysis" class="analysis-display">
                        <p class="panel-hint">Add chords to analyze...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Panel: Visual Keyboard -->
        <div class="keyboard-panel">
            <div class="keyboard-header">
                <h3>Virtual Keyboard</h3>
                <div class="keyboard-controls">
                    <label class="keyboard-option">
                        <input type="checkbox" id="keyboard-highlight-scale" checked>
                        Highlight Scale
                    </label>
                    <label class="keyboard-option">
                        <input type="checkbox" id="keyboard-highlight-chords" checked>
                        Highlight Chord Tones
                    </label>
                    <label class="keyboard-label">
                        Octave:
                        <select id="keyboard-octave" class="keyboard-select">
                            <option value="3">3</option>
                            <option value="4" selected>4</option>
                            <option value="5">5</option>
                        </select>
                    </label>
                </div>
            </div>
            <div id="visual-keyboard" class="visual-keyboard"></div>
        </div>

    </div>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@tonaljs/tonal/browser/tonal.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.js"></script>

    <!-- App Scripts -->
    <script type="module" src="js/audio-engine.js"></script>
    <script src="js/studio-pro.js"></script>
</body>
</html>
